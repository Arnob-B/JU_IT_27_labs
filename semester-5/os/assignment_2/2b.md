# File Transfer Between Parent and Child Processes Using FIFO

## Steps to Implement:

### 1. Using the `fork` System Call, Create a Child Process.
- Use the `fork()` system call to create a new child process.
- The parent process continues execution and the child process starts from the `fork()` point.

### 2. Transfer 1GB File from Parent Process to Child Process Using a FIFO.
- First, create a FIFO (named pipe) using a system call or shell command:
```bash
mkfifo fifo1
```

- The parent process writes the 1GB file to fifo1. You can create a 1GB file using the dd command or any method of your choice:

```
dd if=/dev/urandom of=large_file bs=1M count=1024
```

- This creates a file named large_file with a size of 1GB.

The parent process opens fifo1 and writes the file content to the pipe.

```
cat large_file > fifo1
```

3. Transfer the Same File from Child Process to Parent Process Using Another FIFO.

The child process reads from fifo1 and writes the contents to a second FIFO, fifo2.
Create the second FIFO:

```
mkfifo fifo2
```

The child process reads the file from fifo1 and writes it to fifo2:

```
cat fifo1 > fifo2
```

4. Compare the Two Files (Using cmp or diff Command) to Make Sure That the Same File Has Returned Back.

After the child process has written to fifo2, the parent process can read from fifo2 and save it to a file (e.g., received_file):

```
cat fifo2 > received_file
```

Use the cmp or diff command to compare the original file (large_file) with the received file (received_file):

```
cmp large_file received_file
```

or

```
diff large_file received_file
```


---
--- 

# How to code this in c

## 1. Using the fork System Call to Create a Child Process
To create FIFO, you can either use a shell command (mkfifo) or a system call like mknod() in C.
To create a large file, you can use commands like dd or fallocate in Linux.
Use the ls -l command to show the FIFO and the large file, and attach the output as a comment in the source code:
ls -l large_file fifo1 fifo2

```
#include <stdio.h>
#include <unistd.h>

int main() {
    pid_t pid;

    pid = fork();  // Create a child process

    if (pid == -1) {
        // Fork failed
        perror("Fork failed");
        return 1;
    }

    if (pid == 0) {
        // This block is executed by the child process
        printf("This is the child process\n");
    } else {
        // This block is executed by the parent process
        printf("This is the parent process\n");
    }

    return 0;
}
```

## 2. Transfer 1GB File from Parent Process to Child Process Using a FIFO

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <fcntl.h>

int main() {
    pid_t pid;
    int fd1;

    // Create a FIFO file
    mkfifo("fifo1", 0666);

    pid = fork();  // Create a child process

    if (pid == 0) {
        // Child process will receive data from FIFO
        printf("Child process: Receiving data from FIFO\n");
        fd1 = open("fifo1", O_RDONLY);
        char buffer[1024];
        int bytesRead;

        while ((bytesRead = read(fd1, buffer, sizeof(buffer))) > 0) {
            write(1, buffer, bytesRead);  // Writing data to stdout (or it can be written to another file)
        }

        close(fd1);
    } else {
        // Parent process will send data to FIFO
        printf("Parent process: Sending data to FIFO\n");
        fd1 = open("fifo1", O_WRONLY);
        FILE *file = fopen("large_file", "rb");
        char buffer[1024];
        int bytesRead;

        while ((bytesRead = fread(buffer, 1, sizeof(buffer), file)) > 0) {
            write(fd1, buffer, bytesRead);
        }

        fclose(file);
        close(fd1);
    }

    return 0;
}
```

## 3. Transfer the Same File from Child Process to Parent Process Using Another FIFO

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <fcntl.h>

int main() {
    pid_t pid;
    int fd1, fd2;

    // Create FIFOs for communication
    mkfifo("fifo1", 0666);
    mkfifo("fifo2", 0666);

    pid = fork();  // Create a child process

    if (pid == 0) {  // Child process
        fd1 = open("fifo1", O_RDONLY);  // Read from fifo1
        fd2 = open("fifo2", O_WRONLY);  // Write to fifo2
        char buffer[1024];
        int bytesRead;

        // Transfer data from fifo1 to fifo2
        while ((bytesRead = read(fd1, buffer, sizeof(buffer))) > 0) {
            write(fd2, buffer, bytesRead);
        }

        close(fd1);
        close(fd2);
    } else {  // Parent process
        fd1 = open("fifo1", O_WRONLY);  // Write to fifo1
        fd2 = open("fifo2", O_RDONLY);  // Read from fifo2
        FILE *file = fopen("large_file", "rb");
        char buffer[1024];
        int bytesRead;

        // Transfer data to fifo1
        while ((bytesRead = fread(buffer, 1, sizeof(buffer), file)) > 0) {
            write(fd1, buffer, bytesRead);
        }
        fclose(file);

        // Read back data from fifo2
        FILE *outFile = fopen("received_file", "wb");
        while ((bytesRead = read(fd2, buffer, sizeof(buffer))) > 0) {
            fwrite(buffer, 1, bytesRead, outFile);
        }
        fclose(outFile);

        close(fd1);
        close(fd2);
    }

    return 0;
}
```

## 4. Compare the Two Files (Use cmp or diff Command)

```
#include <stdlib.h>

int main() {
    // Compare the two files using 'cmp'
    system("cmp large_file received_file");

    // Alternatively, you can use the 'diff' command
    system("diff large_file received_file");

    return 0;
}
```

## get the time

If you want to measure the time within the program itself, use clock():

#include <stdio.h>
#include <time.h>

int main() {
    clock_t start, end;
    double cpu_time_used;

    start = clock();

    // Place the file transfer code here (as shown in previous snippets)

    end = clock();
    cpu_time_used = ((double)(end - start)) / CLOCKS_PER_SEC;
    printf("Time taken: %f seconds\n", cpu_time_used);

    return 0;
}

